<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layouts/layout1}">
<meta charset="UTF-8">
<head>
<link th:href="@{/css/vocList.css}" rel="stylesheet">
</head>

<!-- 사용자 스크립트 추가 -->
<th:block layout:fragment="script">
	<script th:inline="javascript">
		$(document).ready(function() {
			$("#searchBtn").on("click", function(e) {
				e.preventDefault();
				page(0);
			});
		});

		function page(page) {
			var searchBy = $("#searchBy").val();
			var searchQuery = $("#searchQuery").val();
			location.href = "/admin/applications/" + page + "?searchBy=" + searchBy
					+ "&searchQuery=" + searchQuery;
		}
	</script>
</th:block>

<div layout:fragment="content">
    
<div>

    <div class="vocList-container">
    <div class="vocList-title">
        <h3>상품관리</h3>
    </div>
    <!--검색기능-->
    <form class="memberMngForm" th:action="@{'/admin/applications/' + ${applications.pageable.pageNumber}}" method="get">
		<div class="vocList-searchOptions" th:object=${applicationSearchDto}>
        <span class="vocList-searchOption-list">
        	<select class="memberMng-select" th:field="*{searchBy}">
        		<option th:value="name">제목</option>
        		<option th:value="writer">작성자</option>
        		<option th:value="programCategory">카테고리</option>
        		<option th:value="approvalStatus">승인상태</option>
        	</select>
        </span>
        <span class="vocList-searchOption-list">
        	<input class="memberMng-select-search" type="text" th:field="*{searchQuery}">
        </span>
        <span class="vocList-searchOption-list">
        	<button class="memberMng-search-btn" type="submit" id="searchBtn">검색</button>
        </span>
        </div>
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
    </form>
    <section class="vocList">

    <form class="applicationForm-txt" name="applicationForm" role="form" method="get" th:object="${application1}">
        <table class="vocList-table">
            <thead>
                <tr class="voc-tr">
                    <td class="vocList-num">프로그램아이디</td>
                    <td class="vocList-name">프로그램명</td>
                    <td class="vocList-category">카테고리</td>
                    <td class="vocList-writer">등록자</td>
                    <td class="vocList-date">등록일</td>
                    <td class="vocList-approvalStatus">승인상태</td>
                    <td class="vocList-approvalStatusYN">승인여부</td>
                </tr>
            </thead>
            <tbody th:align="center">
            
                <tr th:each="application1, status: ${applications.getContent()}">
                    <td class="vocList-num" th:text="${application1.num}"></td>
                    <td class="vocList-name">
                        <a th:href="'/board/program/application/'+${application1.name}" th:text="${application1.name}"></a>
                    </td>
                    <td class="vocList-category" th:text="${application1.programCategory}"></td>
                    <td class="vocList-writer" th:text="${application1.createdBy}"></td>
                    <td class="vocList-date" th:text="${#temporals.format(application1.regTime, 'yy년 MM월 dd일 HH시 mm분')}"></td>
                    <td class="vocList-approvalStatus" th:text="${application1.approvalStatus}"></td>
                    <td class="vocList-approvalStatus-listbutton" th:if="${application1.approvalStatus} == '미승인'" style="text-align: center">
                    	<button class="vocList-approvalStatus-button" th:formaction="@{'/admin/approvalstatus/change/' + ${application1.num}}" type="submit">승인하기</button>
                    </td>
                    <td class="vocList-approvalStatus-listbutton" th:if="${application1.approvalStatus} == '승인'" style="text-align: center">
                    	승인완료
                    </td>
                </tr>
                
            </tbody>
        </table>
      
		<br>

        <!-- <div class="page_wrap">
				<ul class="pagination justify-content-center">
					<li class="page-item" th:classappend="${startPage == applications.pageable.pageNumber + 1} ? 'disabled'">
						<a class="page-link" th:href="'javascript:page(' + ${applications.pageable.pageNumber - 1} + ')'" tabindex="-1" aria-disabled="true">Previous</a>
					</li>
					<li class="page-item" th:classappend="${page == applications.pageable.pageNumber + 1} ? 'active'" th:each="page : ${#numbers.sequence(startPage, endPage)}">
						<a class="page-link" th:href="'javascript:page(' + ${page - 1} + ')'" th:text=${page} aria-current="page">1</a>
					</li>
					<li class="page-item" th:classappend="${endPage == applications.pageable.pageNumber + 1} ? 'disabled'">
						<a class="page-link" th:href="'javascript:page(' + ${applications.pageable.pageNumber + 1} + ')'">Next</a>
					</li>
				</ul>
		</div> -->
		
		<div class="page_wrap" th:with="start=${(applications.number/maxPage)*maxPage + 1}, end=(${(applications.totalPages == 0) ? 1 : (start + (maxPage - 1) < applications.totalPages ? start + (maxPage - 1) : applications.totalPages)})">

            <ul class="pagination justify-content-center">

               <li class="page-item" th:classappend="${applications.first} ? 'disabled'">
                  <a class="page-link" th:href="'javascript:page(' + ${applications.pageable.pageNumber - 1} + ')'" tabindex="-1" aria-disabled="true">Previous</a>
               </li>

               <li class="page-item" th:classappend="${page == applications.pageable.pageNumber + 1} ? 'active'" th:each="page : ${#numbers.sequence(start, end)}">
               	  <a class="page-link" th:href="'javascript:page(' + ${page - 1} + ')'" th:text=${page} aria-current="page">1</a>
               </li>

               <li class="page-item" th:classappend="${applications.last} ? 'disabled'">
                  <a class="page-link" th:href="'javascript:page(' + ${applications.pageable.pageNumber + 1} + ')'">Next</a>
               </li>

            </ul>

         </div>
		
		
		 </form>
		</section>

</div>


</div>
</div>
<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
</html>
