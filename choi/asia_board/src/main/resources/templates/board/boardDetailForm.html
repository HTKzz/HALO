<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layouts/layout1}">
<meta charset="UTF-8">
<head>
<meta name="_csrf" th:content="${_csrf.token}" />
<meta name="_csrf_header" th:content="${_csrf.headerName}" />
</head>
<th:block layout:fragment="script">

	<script th:inline="javascript">
		$(document).ready(function() {
			calculateToalPrice();
			$("#count").change(function() {
				calculateToalPrice();
			});
		});
		function calculateToalPrice() {

			var count = $("#count").val();
			var price = $("#price").val();
			var totalPrice = price * count;
			$("#totalPrice").html(totalPrice + '원');
		}

		function order() {

			var token = $("meta[name='_csrf']").attr("content");
			var header = $("meta[name='_csrf_header']").attr("content");
			var url = "/order";

			var paramData = {
				itemId : $("#itemId").val(),
				count : $("#count").val()
			};

			var param = JSON.stringify(paramData);

			$.ajax({

				url : url,
				type : "POST",
				contentType : "application/json",
				data : param,

				beforeSend : function(xhr) {
					/* 데이터를 전송하기 전에 헤더에 csrf값을 설정 */
					xhr.setRequestHeader(header, token);
				},
				dataType : "json",
				cache : false,

				success : function(result, status) {
					alert("주문이 완료 되었습니다.");
					location.href = '/';
				},
				error : function(jqXHR, status, error) {

					if (jqXHR.status == '401') {
						alert('로그인 후 이용해주세요');
						location.href = '/members/login';

					} else {
						alert(jqXHR.responseText);
					}
				}
			});
		}

		function addCart() {
			var token = $("meta[name='_csrf']").attr("content");
			var header = $("meta[name='_csrf_header']").attr("content");
			var url = "/cart";
			var paramData = {
				itemId : $("#itemId").val(),
				count : $("#count").val()
			};
			var param = JSON.stringify(paramData);
			$.ajax({
				url : url,
				type : "POST",
				contentType : "application/json",
				data : param,
				beforeSend : function(xhr) {
					/* 데이터를 전송하기 전에 헤더에 csrf값을 설정 */
					xhr.setRequestHeader(header, token);
				},
				dataType : "json",
				cache : false,
				success : function(result, status) {
					alert("상품을 장바구니에 담았습니다.");
					location.href = '/';
				},
				error : function(jqXHR, status, error) {
					if (jqXHR.status == '401') {
						alert('로그인 후 이용해주세요');
						location.href = '/members/login';
					} else {
						alert(jqXHR.responseText);
					}
				}
			});
		}
	</script>
</th:block>

<th:block layout:fragment="css">
	<style>

*{
	margin: 0 auto;
    padding: 0 auto;
    list-style: none;
    border: 0;
    text-decoration: none;
}

form{
	width: 1100px;
	height: 100%;
}

a {
	text-decoration: none;
	color: #888888;
}

.headerr{
	float: left;
	width: 100%;
	border-bottom: 1px solid black;
	padding: 120px 15px 20px;
}

.back-to-list{
	float: right;
}

.detail-title{
	padding-top: 20px;
	padding: 50px 13px 27px;
	border-bottom: 1px solid #e2e2e2;
}

.title {
	float: left;
	width: 100%;
}

.view-wrapper{
	width: 100%;
	float: right;
	margin-top: 20px;
	padding-bottom: 20px;
	border-bottom: 1px solid #e2e2e2;
}

.view-date {
	float: right;
    font-size: 12px;
    color: #6b6b6b;
    margin-right: 25px;
    line-height: 1;
}

.view-views{
	float: right;
    font-size: 12px;
    color: #6b6b6b;
    margin-right: 25px;
    line-height: 1;
}

dl {
	position:absolute;
    display: inline-block;
    margin-block-start: 1em;
    margin-block-end: 1em;
    margin-inline-start: 0px;
    margin-inline-end: 0px;
}

dd{
	position:absolute;
	margin-inline-start: 60px;
}

.bodyContent{
	float: left;
	width: 100%;
	text-indent: 25px;
	font-size: 1.2em;
	
	padding: 30px 0px 30px;
	border-bottom: 1px solid #e2e2e2;
}

pre{
	font-size: 1.3em;
	line-height: 200%;
}

.bodyContent_inner{
	text-overflow: none;
}

.mgb-15 {
	display:block;
	margin: auto;
	margin-bottom: 15px;
}

.image {
	margin-right: 15px;
	height: auto;
	width: 50%;
}

.img {
	width: 100%;
	height: 350px;
}

.group-button{
	width: 100%;
	float: left;
	text-align: center;
	letter-spacing: 3px;
	padding: 40px 0px 40px;
	border-bottom: 1px solid #e2e2e2;
}

.button{
	padding-right: 30px;
}

.download{
	float: left;
	width: 100%;
	padding: 15px 0px 25px;
	border-bottom: 1px solid #e2e2e2;
}

.download_text{
	width: 100%;
	line-height: 50px;
}

.download_inner{
	width: 100%;
	display: block;
}

.inner_text{
	width: 100%;
	padding: 30px 20px 30px;
}

</style>
</th:block>

<div layout:fragment="content">
	<form method="get" action="/boards/detail" role="form">
		<!-- <input type="hidden" id="mem_num" th:value="${boardDto.mem_num}"> -->
		<input type="hidden" id="boardNum" th:value="${boardDto.num}">
		<input type="hidden"  name="groupOrd" th:value="${boardDto.groupOrd}">
		<input type="hidden" name="groupLayer" th:value="${boardDto.groupLayer}">
		<div class="headerr">
			<h1>공지사항</h1>
			<a th:href="@{/boards/lists}" class="back-to-list">목록</a>
		</div>
		<div class="title-wrapper">
			<div class="group-detail title">
				<h1 class="detail-title" th:text="${boardDto.name}"></h1>
			</div>
		</div>
		<div class="view-wrapper">
			<div >
				<span class="view-date"  th:text="${#temporals.format(boardDto.regTime, 'yyyy-MM-dd')}"></span>
				<span class="view-views" th:text="${boardDto.cnt}"></span>
				<span class="view-views vie">view</span>
			</div>
		</div>
				<!-- <span class="date">
					작성일 : <span th:text="${boardDto.d_date}"></span>
				</span>
				
				<span class="top">
					작성자 : <span th:text="${boardDto.member.id}" style="width:20%;"></span>
				</span>
				<span class="title">
					<span class="detail-title" th:text="${boardDto.name}"></span>
				</span> -->
			
		<div>
			<div class="bodyContent">
				<!-- 내용 : &nbsp; -->
				<pre><span class="bodyContent_inner" th:text="${boardDto.content}"></span></pre>	
			</div>
		</div>
			<!-- <div th:each="attach : ${boardDto.attachDtoList}" class="text-center">
				<img th:if="${not #strings.isEmpty(attach.url)}"
					th:src="${attach.url}" class="rounded mgb-15" width="800">
			</div> -->
		
		<!-- <div th:if="${Member.num == boardDto.mem_num}"> -->
		<div>
			<div class="group-button">
			<span class="button">
				<a th:href="@{/boards/modForm/{num}(num=${boardDto.num})}">수정하기</a>
			</span>
		
			<span class="button">
				<a th:href="@{'/boards/replyForm/' + ${boardDto.num}}">답글쓰기</a>
				<!-- <button th:formaction="@{'/boards/replyForm/' + ${boardDto.num}}" type="submit" class="btn btn-primary">답글쓰기</button> -->
			</span>
		
			<span class="button">
				<a th:href="@{/boards/lists}">돌아가기</a>
			</span>
		
			<span class="button">
				<a th:href="@{'/boards/deleteBoard/' + ${boardDto.num}}">삭제하기</a>
				<!-- <button th:formaction="@{'/boards/deleteBoard/' + ${boardDto.num}}" type="submit" class="btn btn-primary">삭제</button> -->
			</span>
			</div>
		</div>
		
		<div>
			<div class="download">
				<span class="download_text">다운로드</span>
				<span class="download_inner" th:each="attach : ${boardDto.attachDtoList}">
				
					<a th:if="${not #strings.isEmpty(attach.url)}" th:href="@{/download/{num}(num=${attach.num})}"
				 	th:text="${attach.oriname}"></a>
				</span>
			</div>
		</div>
		
		<div class="detailPrev">
			<ul class="detailPrev_inner">
				<li>
					<a th:href="@{/boards/detail/{num}(num=${boardDto.num-1})}">
						<span th:if="${boardDto.num-1 != 0}">
							<span class="detailPrev inner_text" th:if="${boardDto.allBoardCnt >= boardDto.num}">이전글</span>
							<span class="detailPrev inner_text" th:text="${boardDto.prevContent}"></span>
						</span>
					</a>
				</li>
				<li>
					<a th:href="@{/boards/detail/{num}(num=${boardDto.num+1})}">
						<span class="detailNext inner_text" th:if="${boardDto.allBoardCnt > boardDto.num}">다음글</span>
						<span class="detailNext inner_text" th:text="${boardDto.nextContent}"></span>
					</a>
				</li>
				 <li>
				 	<a>
						<!-- <span class="detailPrev_inner_text" th:if="${boardDto.num(${num-1})"
							 th:alt="이전글">이전글</span> -->
					</a>
				</li>
			</ul>
		</div>
		
		<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
	</form>
	<!-- <form method="get" action="/download/{num}(num=${attach.num})" role="form">
		
	</form> -->
</div>

</html>